;;; The Computer Language Benchmarks Game
;;; http://shootout.alioth.debian.org/
;;;
;;; contributed by Anthony Borla

(define (command-line-arguments) '())
(define (argv) '())

(define (sub1 x) (- x 1))

(define (ack m n)
  (cond ((= m 0) (+ n 1))
        ((= n 0) (ack (- m 1) 1))
        (else (ack (- m 1) (ack m (- n 1))))))

(define (fib n)
  (cond ((< n 2) 1)
	(else (+ (fib (- n 2)) (fib (- n 1))))))

(define (fibflt n)
  (cond ((< n 2.0) 1.0)
	(else (+ (fibflt (- n 2.0)) (fibflt (- n 1.0))))))

(define (tak x y z)
  (cond ((not (< y x)) z)
        (else (tak (tak (- x 1) y z) (tak (- y 1) z x) (tak (- z 1) x y)))))

(define (takflt x y z)
  (cond ((not (< y x)) z)
        (else (takflt (takflt (- x 1.0) y z) (takflt (- y 1.0) z x) (takflt (- z 1.0) x y)))))

(define (main args)
  (let* ((n (if (null? args)
              1
              (string->number (car args))))
         (nfp n))

    (display n) (display (ack 3 n))

    (display (+ 27.0 nfp)) (display (fibflt (+ 27.0 nfp)))

    (set! n (sub1 n))
    (display (* n 3)) (display (* n 2)) (display n) (display (tak (* n 3) (* n 2) n))

    (display (fib 3))
    (display (takflt 3.0 2.0 1.0))))

(main (command-line-arguments))

